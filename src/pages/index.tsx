import Head from 'next/head'
import {Box, Grid} from "@chakra-ui/react"
import Navbar from "@components/Navbar";
import FilterSection from "@components/FilterSection";
import ListApartment from "@components/ListApartment";
import {gql, useQuery} from "@apollo/client";
import client from "@lib/apolloClient";
// import {initializeApollo} from "@lib/apolloClient";
// import {$FIXME} from "@utils/constant";

const FetchApartment = gql`
    query getApartments{
        name
        id
        slots{
            id
            date
            booked
        }
    }
`

const Home = () => {
    const {
        data,
    } = useQuery(FetchApartment)
    console.log('the data', data)
    return (
        <>
            <Head>
                <title>Create Next App</title>
                <meta name="description" content="Generated by create next app"/>
                <link rel="icon" href="/favicon.ico"/>
            </Head>

            <Navbar/>
            <Box
                position='relative'
                px="10rem"
                zIndex={1}
                marginTop={20}>
                <Grid
                    marginTop={7}
                    width='100%'
                    templateColumns="200px 1fr"
                    gap={5}
                >
                    <FilterSection/>
                    <ListApartment/>
                </Grid>
            </Box>
        </>
    )
}

export async function getStaticProps() {
    await client.query({
        query: FetchApartment,
    })

    return {
        props: {
            initialApolloState: client.cache.extract(),
        },
    }
}

export default Home

// export async function getServerSideProps(ctx:$FIXME) {
//     const fetchApartment = gql`
//         query getApartments{
//             name
//             id
//             slots{
//                 id
//                 date
//                 booked
//             }
//         }
//     `
//     const {data} = await initializeApollo(ctx).query({
//         query: fetchApartment
//     })
//     console.log({data})
//     return { props: { data } }
// }
